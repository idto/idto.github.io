<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description"
          content="Inverse Dynamics Trajectory Optimization for Contact-Implicit
                   Model Predictive Control">
    <meta name="keywords" content="robotics, optimizaiton, manipulation, locomotion">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      IDTO: Inverse Dynamics Trajectory Optimization
    </title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
                           integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
    <style>
.videoWrapper {
  position: relative;
  padding-bottom: 56.25%;
  /* 16:9 */
  height: 0;
}

    .videoWrapper iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    </style>
  </head>
  <body>

    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
    </nav>


    <section class="hero">
      <div class="hero-body">
        <div class="container is-max-desktop">
          <div class="columns is-centered">
            <div class="column has-text-centered">
              <h1 class="title is-2 publication-title">
                Inverse Dynamics Trajectory Optimization  <br> for Contact-Implicit
                Model Predictive Control</h1>
              <div class="is-size-5 publication-authors">
                <span class="author-block">
                  Vince Kurtz<sup>1</sup>, &nbsp;
                  Alejandro Castro<sup>2</sup>, &nbsp;
                  Aykut Özgün Önol<sup>2</sup>, &nbsp;
                  Hai Lin<sup>1</sup>
                </span>

                <br>
                <br>

                <div class="is-size-5 publication-authors">
                  <span class="author-block"><sup>1</sup>University of Notre
                    Dame</span> <br>
                  <span class="author-block"><sup>2</sup>Toyota Research Institute</span>
                </div>
                <br>
                <span class="link-block">
                  <a href="coming_soon.html" target="_blank" class="external-link button is-normal is-rounded is-dark"  style="text-decoration: none">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>

                <span class="link-block">
                  <a href="coming_soon.html" target="_blank" class="external-link button is-normal is-rounded is-dark"  style="text-decoration: none">
                    <span class="icon">
                      <i class="fab fa-youtube"></i>
                    </span>
                    <span>Video</span>
                  </a>
                </span>
                
                <span class="link-block">
                  <a href="https://github.com/vincekurtz/drake/tree/idto_paper" target="_blank" class="external-link button is-normal is-rounded is-dark"  style="text-decoration: none">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="hero teaser">
      <div class="columns is-centered has-text-centered">
        <div class="container is-max-desktop">
          <div class="content has-text-justified">
            <div class="columns is-centered interpolation-panel" style="background: #FDFFFF;">
              <div>
                <video autoplay muted loop playsinline  width="98%">
                  <source src="video/bimanual_push.mp4" type="video/mp4"/>
                </video>
              </div>
              <div>
                <video autoplay muted loop playsinline  width="98%">
                  <source src="video/bimanual_lift.mp4" type="video/mp4"/>
                </video>
              </div>
              <div>
                <video autoplay muted loop playsinline  width="98%">
                  <source src="video/bimanual_balance.mp4" type="video/mp4"/>
                </video>
              </div>
            </div>
          </div>
          We present <b>IDTO (Inverse Dynamics Trajectory Optimization)</b>, a
          fast solver for optimization through contact in 
          <a href="https://drake.mit.edu" target="_blank">Drake</a>.
          <br>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
          <div class="column">

            <h2 class="title is-3">Abstract</h2>
            <div class="content has-text-justified">
              <p style="font-size: 18px; text-align: left">
              Robots must make and break contact to perform useful work, but trajectory optimization through
              contact is notoriously difficult. In this paper, we achieve
              real-time contact-implicit model predictive control with a
              surprisingly simple method: <b>inverse dynamics trajectory
                optimization</b>. While trajectory optimization with inverse
              dynamics is not new, we develop a number of small innovations that 
              together enable fast model predictive control on a
              variety of challenging manipulation and locomotion tasks.
              We implement these innovations in an open-source solver,
              and present a variety of simulation examples to support
              the effectiveness of the proposed approach. Additionally,
              we demonstrate contact-implicit model predictive control
              on hardware at over 100 Hz for a 20 degree-of-freedom
              bi-manual manipulation task.
              </p>
              <br>
              <br>
            </div>

            <h2 class="title is-3">Toy Problems</h2>
            <div class="content has-text-justified">
              <p style="font-size: 18px; text-align: left">
              IDTO can be used as an offline trajectory planning tool. The user
              specifies a (quadratic) cost defining the desired behavior. Contact
              timings, sequences, and locations are then determined by the solver. 
              </p>
              <br>
              <br>
              <div class="columns is-centered interpolation-panel" style="background: #FDFFFF;">
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/acrobot_open_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Acrobot</em></p>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/spinner_open_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Spinner</em></p>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/hopper_open_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Hopper</em></p>
                </div>
              </div>
              <br>
              <p style="font-size: 18px; text-align: left">
              IDTO also enables feedback control through contact via Model Predictive Control (MPC).
              For these simple examples, contact-implicit MPC runs in real time at over 100 Hz on a laptop.
              </p>
              <br>
              <br>
              <div class="columns is-centered interpolation-panel" style="background: #FDFFFF;">
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/acrobot_closed_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Acrobot (MPC)</em></p>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/spinner_closed_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Spinner (MPC)</em></p>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/hopper_closed_loop.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Hopper (MPC)</em></p>
                </div>
              </div>
              <br>
            </div>
            
            <h2 class="title is-3">Dextrous Manipulation</h2>
            <div class="content has-text-justified">
              <p style="font-size: 18px; text-align: left">
              IDTO can design a dynamically feasible trajectory that rotates the
              ball even when this Allegro hand is upside down &mdash; something that 
              <a href="https://youtu.be/uWADBSmHebA?t=315" target="_blank">
                reinforcement learning methods struggle</a> with.
              </p>
              <br>
              <br>
              <div class="columns is-centered interpolation-panel" style="background: #FDFFFF;">
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/allegro_rightside_up.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Rightside
                    up (open loop)</em></p>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/allegro_upside_down.mp4" type="video/mp4"/>
                  </video>
                  <p style="font-size: 18px; text-align: center"><em>Upside down
                  (open loop)</em></p>
                </div>
              </div>
              <br>
              <p style="font-size: 18px; text-align: left">
              Contact-implicit MPC runs in real time at about 10 Hz. The planner
              uses a smooth contact model that allows force at a distance, while
              the simulator uses a more realistic <a
                href=https://drake.mit.edu/doxygen_cxx/group__hydroelastic__user__guide.html
                                                    target=_blank>
                hydroelastic contact model</a>. 
              </p>
              <br>
              <br>
              <div class="columns is-centered interpolation-panel" style="background: #FDFFFF;">
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/allegro_rotation_one.mp4" type="video/mp4"/>
                  </video>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/allegro_rotation_three.mp4" type="video/mp4"/>
                  </video>
                </div>
                <div>
                  <video autoplay muted loop playsinline  width="98%">
                    <source src="video/allegro_rotation_four.mp4" type="video/mp4"/>
                  </video>
                </div>
              </div>
              <p style="font-size: 18px; text-align: center"><em>Real-time MPC</em></p>
              <br>
            </div>
            
            <h2 class="title is-3">Legged Locomotion</h2>
            <div class="content has-text-justified">
              <p style="font-size: 18px; text-align: left">
              Contact-implicit MPC runs at about 60 Hz for a
              quadruped in simulation. We don't specify a desired gait or a
              preferred contact sequence. The solver chooses when and where to
              make contact on the fly: trotting emerges automatically.
              </p>
              <br>
              <br>
              <div class="columns is-centered" style="background: #FDFFFF">
                <video autoplay muted loop playsinline  width="98%">
                  <source src="video/mini_cheetah.mp4" type="video/mp4"/>
                </video>
              </div>
              <br>
              <p style="font-size: 18px; text-align: left">
              The robot stops automatically when it reaches the edge of a
              platform, even though the cost function says to keep going. 
              </p>
              <br>
              <br>
              <div class="columns is-centered" style="background: #FDFFFF">
                <video autoplay muted loop playsinline  width="98%">
                  <source src="video/mini_cheetah_edge.mp4" type="video/mp4"/>
                </video>
              </div>
              <br>
            </div>
          </div>
        </div>
    </section>
        
    <section class="section" id="BibTeX">
      <div class="container is-max-desktop content">
        <h2 class="title">Questions?</h2>
        Feel free to <a href="mailto:vjkurtz@gmail.com?subject=IDTO: Inverse Dynamics Trajectory Optimization">reach out!</a>
      </div>
    </section>

    <section class="section" id="BibTeX">
      <div class="container is-max-desktop content">
        <h2 class="title">BibTeX</h2>
        <pre><code>
    @article{kurtz2023inverse,
      title          = {Inverse Dynamics Trajectory Optimization for Contact-Implicit Model Predictive Control},
      author         = {Kurtz, Vince and Castro, Alejandro and \"{O}nol, Aykut \"{O}zg\"{u}n and Lin, Hai}
      year           = {2023},
    }
        </code></pre>
      </div>
    </section>

  </body>
</html>
